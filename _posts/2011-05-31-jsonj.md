---
id: 873
title: 'Jsonj: a new library for working with JSon in Java'
date: 2011-05-31T00:53:04+00:00
author: Jilles
layout: post
guid: http://www.jillesvangurp.com/?p=873
permalink: /2011/05/31/jsonj/
aktt_notify_twitter:
  - 'yes'
aktt_tweeted:
  - "1"
dsq_thread_id:
  - "336376988"
wp-syntax-cache-content:
  - |
    a:1:{i:1;s:30766:"
    <div class="wp_syntax" style="position:relative;"><table><tr><td class="line_numbers"><pre>1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20
    21
    22
    23
    24
    25
    26
    27
    28
    29
    30
    31
    32
    33
    34
    35
    36
    37
    38
    39
    40
    41
    42
    43
    44
    45
    46
    47
    48
    49
    50
    51
    52
    53
    54
    55
    56
    57
    58
    59
    60
    61
    62
    63
    64
    65
    66
    67
    68
    69
    70
    71
    72
    73
    74
    75
    76
    77
    78
    79
    80
    81
    82
    83
    84
    85
    86
    87
    88
    89
    90
    91
    92
    93
    94
    95
    96
    97
    98
    99
    100
    101
    102
    103
    104
    105
    106
    107
    108
    109
    110
    111
    112
    113
    </pre></td><td class="code"><pre class="java" style="font-family:monospace;"><span style="color: #008000; font-style: italic; font-weight: bold;">/**
    * Copyright (c) 2011, Jilles van Gurp
    *
    * Permission is hereby granted, free of charge, to any person obtaining a copy
    * of this software and associated documentation files (the &quot;Software&quot;), to deal
    * in the Software without restriction, including without limitation the rights
    * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    * copies of the Software, and to permit persons to whom the Software is
    * furnished to do so, subject to the following conditions:
    *
    * The above copyright notice and this permission notice shall be included in
    * all copies or substantial portions of the Software.
    *
    * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    * SOFTWARE.
    */</span>
    <span style="color: #000000; font-weight: bold;">package</span> <span style="color: #006699;">org.jsonj</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">static</span> org.<span style="color: #006633;">jsonj</span>.<span style="color: #006633;">tools</span>.<span style="color: #006633;">JsonBuilder</span>.<span style="color: #006633;">array</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">static</span> org.<span style="color: #006633;">jsonj</span>.<span style="color: #006633;">tools</span>.<span style="color: #006633;">JsonBuilder</span>.<span style="color: #006633;">nullValue</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">static</span> org.<span style="color: #006633;">jsonj</span>.<span style="color: #006633;">tools</span>.<span style="color: #006633;">JsonBuilder</span>.<span style="color: #006633;">object</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">static</span> org.<span style="color: #006633;">jsonj</span>.<span style="color: #006633;">tools</span>.<span style="color: #006633;">JsonBuilder</span>.<span style="color: #006633;">primitive</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">static</span> org.<span style="color: #006633;">jsonj</span>.<span style="color: #006633;">tools</span>.<span style="color: #006633;">JsonSerializer</span>.<span style="color: #006633;">serialize</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">static</span> org.<span style="color: #006633;">jsonj</span>.<span style="color: #006633;">tools</span>.<span style="color: #006633;">JsonSerializer</span>.<span style="color: #006633;">write</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">static</span> org.<span style="color: #006633;">testng</span>.<span style="color: #000000; font-weight: bold;">Assert</span>.<span style="color: #006633;">assertTrue</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">java.io.IOException</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">java.util.LinkedHashMap</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">java.util.LinkedList</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">org.jsonj.tools.JsonParser</span><span style="color: #339933;">;</span>
    <span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">org.testng.annotations.Test</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #008000; font-style: italic; font-weight: bold;">/**
    * Not really a test but a nice place to show off some how to use this.
    */</span>
    @Test
    <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">class</span> ShowOffTheFramework <span style="color: #009900;">&#123;</span>
    &nbsp;
    <span style="color: #008000; font-style: italic; font-weight: bold;">/** this could be a singleton or a spring injected object, threadsafe of course. */</span>
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">final</span> JsonParser jsonParser <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> JsonParser<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;;</span>
    &nbsp;
    <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> whatCanThisBabyDo<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #000000; font-weight: bold;">throws</span> <span style="color: #003399;">IOException</span> <span style="color: #009900;">&#123;</span>
    JsonObject object <span style="color: #339933;">=</span> object<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;its&quot;</span>, <span style="color: #0000ff;">&quot;just a hash map&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;and&quot;</span>, array<span style="color: #009900;">&#40;</span>
    primitive<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;adding&quot;</span><span style="color: #009900;">&#41;</span>,
    primitive<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;stuff&quot;</span><span style="color: #009900;">&#41;</span>,
    object<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;is&quot;</span>, <span style="color: #0000ff;">&quot;easy&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>,
    array<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;another array&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;numbers&quot;</span>, <span style="color: #cc66cc;">42</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;including_this_one&quot;</span>, <span style="color: #cc66cc;">42.0</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;booleanstoo&quot;</span>, <span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;nulls_if_you_insist&quot;</span>, nullValue<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>, object<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;b&quot;</span>, object<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;c&quot;</span>, <span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;d&quot;</span>, <span style="color: #cc66cc;">42</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;e&quot;</span>, <span style="color: #0000ff;">&quot;hi!&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;array&quot;</span>,
    array<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;1&quot;</span>, <span style="color: #0000ff;">&quot;2&quot;</span>, <span style="color: #0000ff;">&quot;etc&quot;</span>, <span style="color: #0000ff;">&quot;varargs are nice&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    assertTrue<span style="color: #009900;">&#40;</span>object <span style="color: #000000; font-weight: bold;">instanceof</span> LinkedHashMap, <span style="color: #0000ff;">&quot;JsonObject actually extends LinkedHashMap&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #666666; font-style: italic;">// get with varargs, a natural evolution for Map</span>
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>,<span style="color: #0000ff;">&quot;b&quot;</span>,<span style="color: #0000ff;">&quot;c&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">asPrimitive</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">asBoolean</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>, <span style="color: #0000ff;">&quot;extract stuff from a nested object&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">getBoolean</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>,<span style="color: #0000ff;">&quot;b&quot;</span>,<span style="color: #0000ff;">&quot;c&quot;</span><span style="color: #009900;">&#41;</span>, <span style="color: #0000ff;">&quot;or like this&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">getInt</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>,<span style="color: #0000ff;">&quot;b&quot;</span>,<span style="color: #0000ff;">&quot;d&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">42</span>, <span style="color: #0000ff;">&quot;or an integer&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">getString</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>,<span style="color: #0000ff;">&quot;b&quot;</span>,<span style="color: #0000ff;">&quot;e&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">equals</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;hi!&quot;</span><span style="color: #009900;">&#41;</span>, <span style="color: #0000ff;">&quot;or a string&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">getArray</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;array&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">isArray</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>, <span style="color: #0000ff;">&quot;works for arrays as well&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">getObject</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>,<span style="color: #0000ff;">&quot;b&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">isObject</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>, <span style="color: #0000ff;">&quot;and objects&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #666666; font-style: italic;">// builders are nice, but still feels kind of repetitive</span>
    JsonObject anotherObject <span style="color: #339933;">=</span> object.<span style="color: #006633;">getOrCreateObject</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;1&quot;</span>,<span style="color: #0000ff;">&quot;2&quot;</span>,<span style="color: #0000ff;">&quot;3&quot;</span>,<span style="color: #0000ff;">&quot;4&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    anotherObject.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;5&quot;</span>, <span style="color: #0000ff;">&quot;xxx&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">getString</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;1&quot;</span>,<span style="color: #0000ff;">&quot;2&quot;</span>,<span style="color: #0000ff;">&quot;3&quot;</span>,<span style="color: #0000ff;">&quot;4&quot;</span>,<span style="color: #0000ff;">&quot;5&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">equals</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;xxx&quot;</span><span style="color: #009900;">&#41;</span>,<span style="color: #0000ff;">&quot;yep, we just added a string value 5 levels deep&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    JsonArray anotherArray <span style="color: #339933;">=</span> object.<span style="color: #006633;">getOrCreateArray</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;5&quot;</span>,<span style="color: #0000ff;">&quot;4&quot;</span>,<span style="color: #0000ff;">&quot;3&quot;</span>,<span style="color: #0000ff;">&quot;2&quot;</span>,<span style="color: #0000ff;">&quot;1&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    anotherArray.<span style="color: #006633;">add</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;xxx&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">getArray</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;5&quot;</span>,<span style="color: #0000ff;">&quot;4&quot;</span>,<span style="color: #0000ff;">&quot;3&quot;</span>,<span style="color: #0000ff;">&quot;2&quot;</span>,<span style="color: #0000ff;">&quot;1&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">contains</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;xxx&quot;</span><span style="color: #009900;">&#41;</span>,<span style="color: #0000ff;">&quot;naturally works for arrays too&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #666666; font-style: italic;">// Lets do some other stuff</span>
    assertTrue<span style="color: #009900;">&#40;</span>object.<span style="color: #006633;">equals</span><span style="color: #009900;">&#40;</span>object<span style="color: #009900;">&#41;</span>,
    <span style="color: #0000ff;">&quot;equals is implemented as a deep equals&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>array<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>, <span style="color: #0000ff;">&quot;b&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">equals</span><span style="color: #009900;">&#40;</span>array<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;b&quot;</span>, <span style="color: #0000ff;">&quot;a&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>,
    <span style="color: #0000ff;">&quot;mostly you shouldn't care about the order of stuff in json&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>
    object<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>, <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;b&quot;</span>, <span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #006633;">equals</span><span style="color: #009900;">&#40;</span>
    object<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;b&quot;</span>, <span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span>, <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>,
    <span style="color: #0000ff;">&quot;true for objects as well&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #666666; font-style: italic;">// Arrays are lists</span>
    JsonArray array <span style="color: #339933;">=</span> array<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;foo&quot;</span>, <span style="color: #0000ff;">&quot;bar&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>array <span style="color: #000000; font-weight: bold;">instanceof</span> <span style="color: #003399;">LinkedList</span>, <span style="color: #0000ff;">&quot;JsonArray extends LinkedList&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>array.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> array.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;bar&quot;</span><span style="color: #009900;">&#41;</span>, <span style="color: #0000ff;">&quot;returns the same object&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>array.<span style="color: #006633;">contains</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;foo&quot;</span><span style="color: #009900;">&#41;</span>, <span style="color: #0000ff;">&quot;obviously&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    assertTrue<span style="color: #009900;">&#40;</span>array.<span style="color: #006633;">contains</span><span style="color: #009900;">&#40;</span>primitive<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;foo&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>, <span style="color: #0000ff;">&quot;but this works as well&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #666666; font-style: italic;">// serialize like this</span>
    <span style="color: #003399;">String</span> serialized <span style="color: #339933;">=</span> serialize<span style="color: #009900;">&#40;</span>object<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #666666; font-style: italic;">// parse it</span>
    JsonElement json <span style="color: #339933;">=</span> jsonParser.<span style="color: #006633;">parse</span><span style="color: #009900;">&#40;</span>serialized<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #666666; font-style: italic;">// and write it straight to some stream</span>
    write<span style="color: #009900;">&#40;</span><span style="color: #003399;">System</span>.<span style="color: #006633;">out</span>, json, <span style="color: #000066; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    &nbsp;
    <span style="color: #666666; font-style: italic;">// or pretty print it like this</span>
    <span style="color: #003399;">System</span>.<span style="color: #006633;">out</span>.<span style="color: #006633;">println</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">+</span> serialize<span style="color: #009900;">&#40;</span>json, <span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
    <span style="color: #009900;">&#125;</span></pre></td></tr></table><p class="theCode" style="display:none;">/**
    * Copyright (c) 2011, Jilles van Gurp
    *
    * Permission is hereby granted, free of charge, to any person obtaining a copy
    * of this software and associated documentation files (the &quot;Software&quot;), to deal
    * in the Software without restriction, including without limitation the rights
    * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    * copies of the Software, and to permit persons to whom the Software is
    * furnished to do so, subject to the following conditions:
    *
    * The above copyright notice and this permission notice shall be included in
    * all copies or substantial portions of the Software.
    *
    * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    * SOFTWARE.
    */
    package org.jsonj;
    
    import static org.jsonj.tools.JsonBuilder.array;
    import static org.jsonj.tools.JsonBuilder.nullValue;
    import static org.jsonj.tools.JsonBuilder.object;
    import static org.jsonj.tools.JsonBuilder.primitive;
    import static org.jsonj.tools.JsonSerializer.serialize;
    import static org.jsonj.tools.JsonSerializer.write;
    import static org.testng.Assert.assertTrue;
    
    import java.io.IOException;
    import java.util.LinkedHashMap;
    import java.util.LinkedList;
    
    import org.jsonj.tools.JsonParser;
    import org.testng.annotations.Test;
    
    /**
    * Not really a test but a nice place to show off some how to use this.
    */
    @Test
    public class ShowOffTheFramework {
    
    /** this could be a singleton or a spring injected object, threadsafe of course. */
    private final JsonParser jsonParser = new JsonParser();;
    
    public void whatCanThisBabyDo() throws IOException {
    JsonObject object = object()
    .put(&quot;its&quot;, &quot;just a hash map&quot;)
    .put(&quot;and&quot;, array(
    primitive(&quot;adding&quot;),
    primitive(&quot;stuff&quot;),
    object().put(&quot;is&quot;, &quot;easy&quot;).get(),
    array(&quot;another array&quot;)))
    .put(&quot;numbers&quot;, 42)
    .put(&quot;including_this_one&quot;, 42.0)
    .put(&quot;booleanstoo&quot;, true)
    .put(&quot;nulls_if_you_insist&quot;, nullValue())
    .put(&quot;a&quot;, object().put(&quot;b&quot;, object().put(&quot;c&quot;, true).put(&quot;d&quot;, 42).put(&quot;e&quot;, &quot;hi!&quot;).get()).get())
    .put(&quot;array&quot;,
    array(&quot;1&quot;, &quot;2&quot;, &quot;etc&quot;, &quot;varargs are nice&quot;)).get();
    
    assertTrue(object instanceof LinkedHashMap, &quot;JsonObject actually extends LinkedHashMap&quot;);
    
    // get with varargs, a natural evolution for Map
    assertTrue(object.get(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;).asPrimitive().asBoolean(), &quot;extract stuff from a nested object&quot;);
    assertTrue(object.getBoolean(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;), &quot;or like this&quot;);
    assertTrue(object.getInt(&quot;a&quot;,&quot;b&quot;,&quot;d&quot;) == 42, &quot;or an integer&quot;);
    assertTrue(object.getString(&quot;a&quot;,&quot;b&quot;,&quot;e&quot;).equals(&quot;hi!&quot;), &quot;or a string&quot;);
    
    assertTrue(object.getArray(&quot;array&quot;).isArray(), &quot;works for arrays as well&quot;);
    assertTrue(object.getObject(&quot;a&quot;,&quot;b&quot;).isObject(), &quot;and objects&quot;);
    
    // builders are nice, but still feels kind of repetitive
    JsonObject anotherObject = object.getOrCreateObject(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;);
    anotherObject.put(&quot;5&quot;, &quot;xxx&quot;);
    assertTrue(object.getString(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;).equals(&quot;xxx&quot;),&quot;yep, we just added a string value 5 levels deep&quot;);
    JsonArray anotherArray = object.getOrCreateArray(&quot;5&quot;,&quot;4&quot;,&quot;3&quot;,&quot;2&quot;,&quot;1&quot;);
    anotherArray.add(&quot;xxx&quot;);
    assertTrue(object.getArray(&quot;5&quot;,&quot;4&quot;,&quot;3&quot;,&quot;2&quot;,&quot;1&quot;).contains(&quot;xxx&quot;),&quot;naturally works for arrays too&quot;);
    
    // Lets do some other stuff
    assertTrue(object.equals(object),
    &quot;equals is implemented as a deep equals&quot;);
    assertTrue(array(&quot;a&quot;, &quot;b&quot;).equals(array(&quot;b&quot;, &quot;a&quot;)),
    &quot;mostly you shouldn't care about the order of stuff in json&quot;);
    assertTrue(
    object().put(&quot;a&quot;, 1).put(&quot;b&quot;, 2).get()
    .equals(
    object().put(&quot;b&quot;, 2).put(&quot;a&quot;, 1).get()),
    &quot;true for objects as well&quot;);
    
    // Arrays are lists
    JsonArray array = array(&quot;foo&quot;, &quot;bar&quot;);
    assertTrue(array instanceof LinkedList, &quot;JsonArray extends LinkedList&quot;);
    assertTrue(array.get(1) == array.get(&quot;bar&quot;), &quot;returns the same object&quot;);
    assertTrue(array.contains(&quot;foo&quot;), &quot;obviously&quot;);
    assertTrue(array.contains(primitive(&quot;foo&quot;)), &quot;but this works as well&quot;);
    
    // serialize like this
    String serialized = serialize(object);
    
    // parse it
    JsonElement json = jsonParser.parse(serialized);
    
    // and write it straight to some stream
    write(System.out, json, false);
    
    // or pretty print it like this
    System.out.println(&quot;\n&quot; + serialize(json, true));
    }
    }</p></div>
    ";}
categories:
  - Blog Posts
tags:
  - IMPLIED
  - java
  - LIABILITY
  - maven
  - SOFTWARE
---
**Update 11 July 2011**: *I've done several commits on github since announcing the project here. New features have been added; bugs have been fixed; you can find jsonj on maven central now as well; etc. In short, head over to [github]( https://github.com/jillesvangurp/jsonj) for the latest on this.*

I've just uploaded a weekend project to github. So, here it is, [jsonj]( https://github.com/jillesvangurp/jsonj). Enjoy.

If you read my post on [json](https://www.jillesvangurp.com/2011/04/02/on-java-json-and-complexity/) a few weeks ago, you may have guessed that I'm not entirely happy with the state of json in Java relative to other languages that come with native support for json. I can't fix that entirely but I felt I could do a better job than most other frameworks I've been exposed to.

So, I sat down on Sunday and started pushing this idea of just taking the Collections framework and combining that with the design of the Json classes in GSon, which I use at work currently, and throwing in some useful ideas that I've applied at work. The result is a nice, compact little framework that does most of what I need it to do. I will probably add a few more features to it and expand some of the existing ones. I use some static methods at work that I can probably do in a much nicer way in this framework. 

<!--more-->

Here is some example usage (note, this will likely not stay in sync with the code in github, check there for latest version):

**Updated to version 0.3, check [here](https://github.com/jillesvangurp/jsonj/blob/master/src/test/java/com/github/jsonj/ShowOffTheFramework.java) for latest version**

<pre lang="JAVA" line="1">
/**
 * Copyright (c) 2011, Jilles van Gurp
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
package org.jsonj;

import static org.jsonj.tools.JsonBuilder.array;
import static org.jsonj.tools.JsonBuilder.nullValue;
import static org.jsonj.tools.JsonBuilder.object;
import static org.jsonj.tools.JsonBuilder.primitive;
import static org.jsonj.tools.JsonSerializer.serialize;
import static org.jsonj.tools.JsonSerializer.write;
import static org.testng.Assert.assertTrue;

import java.io.IOException;
import java.util.LinkedHashMap;
import java.util.LinkedList;

import org.jsonj.tools.JsonParser;
import org.testng.annotations.Test;

/**
 * Not really a test but a nice place to show off some how to use this.
 */
@Test
public class ShowOffTheFramework {

	/** this could be a singleton or a spring injected object, threadsafe of course. */
	private final JsonParser jsonParser = new JsonParser();;

	public void whatCanThisBabyDo() throws IOException {
		JsonObject object = object()
			.put("its", "just a hash map")
			.put("and", array(
				primitive("adding"),
				primitive("stuff"),
				object().put("is", "easy").get(),
				array("another array")))
			.put("numbers", 42)
			.put("including_this_one", 42.0)
			.put("booleanstoo", true)
			.put("nulls_if_you_insist", nullValue())
			.put("a", object().put("b", object().put("c", true).put("d", 42).put("e", "hi!").get()).get())
			.put("array",
				array("1", "2", "etc", "varargs are nice")).get();

		assertTrue(object instanceof LinkedHashMap, "JsonObject actually extends LinkedHashMap");

		// get with varargs, a natural evolution for Map
		assertTrue(object.get("a","b","c").asPrimitive().asBoolean(), "extract stuff from a nested object");
		assertTrue(object.getBoolean("a","b","c"), "or like this");
		assertTrue(object.getInt("a","b","d") == 42, "or an integer");
		assertTrue(object.getString("a","b","e").equals("hi!"), "or a string");

		assertTrue(object.getArray("array").isArray(), "works for arrays as well");
		assertTrue(object.getObject("a","b").isObject(), "and objects");

		// builders are nice, but still feels kind of repetitive
		JsonObject anotherObject = object.getOrCreateObject("1","2","3","4");
		anotherObject.put("5", "xxx");
		assertTrue(object.getString("1","2","3","4","5").equals("xxx"),"yep, we just added a string value 5 levels deep");
		JsonArray anotherArray = object.getOrCreateArray("5","4","3","2","1");
		anotherArray.add("xxx");
		assertTrue(object.getArray("5","4","3","2","1").contains("xxx"),"naturally works for arrays too");

		// Lets do some other stuff
		assertTrue(object.equals(object),
			"equals is implemented as a deep equals");
		assertTrue(array("a", "b").equals(array("b", "a")),
			"mostly you shouldn't care about the order of stuff in json");
		assertTrue(
			object().put("a", 1).put("b", 2).get()
			.equals(
				object().put("b", 2).put("a", 1).get()),
			"true for objects as well");

		// Arrays are lists
		JsonArray array = array("foo", "bar");
		assertTrue(array instanceof LinkedList, "JsonArray extends LinkedList");
		assertTrue(array.get(1) == array.get("bar"), "returns the same object");
		assertTrue(array.contains("foo"), "obviously");
		assertTrue(array.contains(primitive("foo")), "but this works as well");

		// serialize like this
		String serialized = serialize(object);

		// parse it
		JsonElement json = jsonParser.parse(serialized);

		// and write it straight to some stream
		write(System.out, json, false);

		// or pretty print it like this
		System.out.println("\n" + serialize(json, true));
	}
}
</pre>

