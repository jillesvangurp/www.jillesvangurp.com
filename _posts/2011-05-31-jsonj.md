---
id: 873
title: 'Jsonj: a new library for working with JSon in Java'
date: 2011-05-31T00:53:04+00:00
author: Jilles
layout: post
guid: http://www.jillesvangurp.com/?p=873
permalink: /2011/05/31/jsonj/
aktt_notify_twitter:
  - 'yes'
aktt_tweeted:
  - "1"
dsq_thread_id:
  - "336376988"
wp-syntax-cache-content:
  - |
    a:1:{i:1;s:30766:"
    <div class="wp_syntax" style="position:relative;"><table><tr><td class="line_numbers">
```
1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20
    21
    22
    23
    24
    25
    26
    27
    28
    29
    30
    31
    32
    33
    34
    35
    36
    37
    38
    39
    40
    41
    42
    43
    44
    45
    46
    47
    48
    49
    50
    51
    52
    53
    54
    55
    56
    57
    58
    59
    60
    61
    62
    63
    64
    65
    66
    67
    68
    69
    70
    71
    72
    73
    74
    75
    76
    77
    78
    79
    80
    81
    82
    83
    84
    85
    86
    87
    88
    89
    90
    91
    92
    93
    94
    95
    96
    97
    98
    99
    100
    101
    102
    103
    104
    105
    106
    107
    108
    109
    110
    111
    112
    113

```
</td><td class="code">
```
/**
    * Copyright (c) 2011, Jilles van Gurp
    *
    * Permission is hereby granted, free of charge, to any person obtaining a copy
    * of this software and associated documentation files (the &quot;Software&quot;), to deal
    * in the Software without restriction, including without limitation the rights
    * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    * copies of the Software, and to permit persons to whom the Software is
    * furnished to do so, subject to the following conditions:
    *
    * The above copyright notice and this permission notice shall be included in
    * all copies or substantial portions of the Software.
    *
    * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    * SOFTWARE.
    */
    package org.jsonj;
    &nbsp;
    import static org.jsonj.tools.JsonBuilder.array;
    import static org.jsonj.tools.JsonBuilder.nullValue;
    import static org.jsonj.tools.JsonBuilder.object;
    import static org.jsonj.tools.JsonBuilder.primitive;
    import static org.jsonj.tools.JsonSerializer.serialize;
    import static org.jsonj.tools.JsonSerializer.write;
    import static org.testng.Assert.assertTrue;
    &nbsp;
    import java.io.IOException;
    import java.util.LinkedHashMap;
    import java.util.LinkedList;
    &nbsp;
    import org.jsonj.tools.JsonParser;
    import org.testng.annotations.Test;
    &nbsp;
    /**
    * Not really a test but a nice place to show off some how to use this.
    */
    @Test
    public class ShowOffTheFramework &#123;
    &nbsp;
    /** this could be a singleton or a spring injected object, threadsafe of course. */
    private final JsonParser jsonParser = new JsonParser&#40;&#41;;;
    &nbsp;
    public void whatCanThisBabyDo&#40;&#41; throws IOException &#123;
    JsonObject object = object&#40;&#41;
    .put&#40;&quot;its&quot;, &quot;just a hash map&quot;&#41;
    .put&#40;&quot;and&quot;, array&#40;
    primitive&#40;&quot;adding&quot;&#41;,
    primitive&#40;&quot;stuff&quot;&#41;,
    object&#40;&#41;.put&#40;&quot;is&quot;, &quot;easy&quot;&#41;.get&#40;&#41;,
    array&#40;&quot;another array&quot;&#41;&#41;&#41;
    .put&#40;&quot;numbers&quot;, 42&#41;
    .put&#40;&quot;including_this_one&quot;, 42.0&#41;
    .put&#40;&quot;booleanstoo&quot;, true&#41;
    .put&#40;&quot;nulls_if_you_insist&quot;, nullValue&#40;&#41;&#41;
    .put&#40;&quot;a&quot;, object&#40;&#41;.put&#40;&quot;b&quot;, object&#40;&#41;.put&#40;&quot;c&quot;, true&#41;.put&#40;&quot;d&quot;, 42&#41;.put&#40;&quot;e&quot;, &quot;hi!&quot;&#41;.get&#40;&#41;&#41;.get&#40;&#41;&#41;
    .put&#40;&quot;array&quot;,
    array&#40;&quot;1&quot;, &quot;2&quot;, &quot;etc&quot;, &quot;varargs are nice&quot;&#41;&#41;.get&#40;&#41;;
    &nbsp;
    assertTrue&#40;object instanceof LinkedHashMap, &quot;JsonObject actually extends LinkedHashMap&quot;&#41;;
    &nbsp;
    // get with varargs, a natural evolution for Map
    assertTrue&#40;object.get&#40;&quot;a&quot;,&quot;b&quot;,&quot;c&quot;&#41;.asPrimitive&#40;&#41;.asBoolean&#40;&#41;, &quot;extract stuff from a nested object&quot;&#41;;
    assertTrue&#40;object.getBoolean&#40;&quot;a&quot;,&quot;b&quot;,&quot;c&quot;&#41;, &quot;or like this&quot;&#41;;
    assertTrue&#40;object.getInt&#40;&quot;a&quot;,&quot;b&quot;,&quot;d&quot;&#41; == 42, &quot;or an integer&quot;&#41;;
    assertTrue&#40;object.getString&#40;&quot;a&quot;,&quot;b&quot;,&quot;e&quot;&#41;.equals&#40;&quot;hi!&quot;&#41;, &quot;or a string&quot;&#41;;
    &nbsp;
    assertTrue&#40;object.getArray&#40;&quot;array&quot;&#41;.isArray&#40;&#41;, &quot;works for arrays as well&quot;&#41;;
    assertTrue&#40;object.getObject&#40;&quot;a&quot;,&quot;b&quot;&#41;.isObject&#40;&#41;, &quot;and objects&quot;&#41;;
    &nbsp;
    // builders are nice, but still feels kind of repetitive
    JsonObject anotherObject = object.getOrCreateObject&#40;&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;&#41;;
    anotherObject.put&#40;&quot;5&quot;, &quot;xxx&quot;&#41;;
    assertTrue&#40;object.getString&#40;&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;&#41;.equals&#40;&quot;xxx&quot;&#41;,&quot;yep, we just added a string value 5 levels deep&quot;&#41;;
    JsonArray anotherArray = object.getOrCreateArray&#40;&quot;5&quot;,&quot;4&quot;,&quot;3&quot;,&quot;2&quot;,&quot;1&quot;&#41;;
    anotherArray.add&#40;&quot;xxx&quot;&#41;;
    assertTrue&#40;object.getArray&#40;&quot;5&quot;,&quot;4&quot;,&quot;3&quot;,&quot;2&quot;,&quot;1&quot;&#41;.contains&#40;&quot;xxx&quot;&#41;,&quot;naturally works for arrays too&quot;&#41;;
    &nbsp;
    // Lets do some other stuff
    assertTrue&#40;object.equals&#40;object&#41;,
    &quot;equals is implemented as a deep equals&quot;&#41;;
    assertTrue&#40;array&#40;&quot;a&quot;, &quot;b&quot;&#41;.equals&#40;array&#40;&quot;b&quot;, &quot;a&quot;&#41;&#41;,
    &quot;mostly you shouldn't care about the order of stuff in json&quot;&#41;;
    assertTrue&#40;
    object&#40;&#41;.put&#40;&quot;a&quot;, 1&#41;.put&#40;&quot;b&quot;, 2&#41;.get&#40;&#41;
    .equals&#40;
    object&#40;&#41;.put&#40;&quot;b&quot;, 2&#41;.put&#40;&quot;a&quot;, 1&#41;.get&#40;&#41;&#41;,
    &quot;true for objects as well&quot;&#41;;
    &nbsp;
    // Arrays are lists
    JsonArray array = array&#40;&quot;foo&quot;, &quot;bar&quot;&#41;;
    assertTrue&#40;array instanceof LinkedList, &quot;JsonArray extends LinkedList&quot;&#41;;
    assertTrue&#40;array.get&#40;1&#41; == array.get&#40;&quot;bar&quot;&#41;, &quot;returns the same object&quot;&#41;;
    assertTrue&#40;array.contains&#40;&quot;foo&quot;&#41;, &quot;obviously&quot;&#41;;
    assertTrue&#40;array.contains&#40;primitive&#40;&quot;foo&quot;&#41;&#41;, &quot;but this works as well&quot;&#41;;
    &nbsp;
    // serialize like this
    String serialized = serialize&#40;object&#41;;
    &nbsp;
    // parse it
    JsonElement json = jsonParser.parse&#40;serialized&#41;;
    &nbsp;
    // and write it straight to some stream
    write&#40;System.out, json, false&#41;;
    &nbsp;
    // or pretty print it like this
    System.out.println&#40;&quot;\n&quot; + serialize&#40;json, true&#41;&#41;;
    &#125;
    &#125;
```
</td></tr></table><p class="theCode" style="display:none;">/**
    * Copyright (c) 2011, Jilles van Gurp
    *
    * Permission is hereby granted, free of charge, to any person obtaining a copy
    * of this software and associated documentation files (the &quot;Software&quot;), to deal
    * in the Software without restriction, including without limitation the rights
    * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    * copies of the Software, and to permit persons to whom the Software is
    * furnished to do so, subject to the following conditions:
    *
    * The above copyright notice and this permission notice shall be included in
    * all copies or substantial portions of the Software.
    *
    * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    * SOFTWARE.
    */
    package org.jsonj;
    
    import static org.jsonj.tools.JsonBuilder.array;
    import static org.jsonj.tools.JsonBuilder.nullValue;
    import static org.jsonj.tools.JsonBuilder.object;
    import static org.jsonj.tools.JsonBuilder.primitive;
    import static org.jsonj.tools.JsonSerializer.serialize;
    import static org.jsonj.tools.JsonSerializer.write;
    import static org.testng.Assert.assertTrue;
    
    import java.io.IOException;
    import java.util.LinkedHashMap;
    import java.util.LinkedList;
    
    import org.jsonj.tools.JsonParser;
    import org.testng.annotations.Test;
    
    /**
    * Not really a test but a nice place to show off some how to use this.
    */
    @Test
    public class ShowOffTheFramework {
    
    /** this could be a singleton or a spring injected object, threadsafe of course. */
    private final JsonParser jsonParser = new JsonParser();;
    
    public void whatCanThisBabyDo() throws IOException {
    JsonObject object = object()
    .put(&quot;its&quot;, &quot;just a hash map&quot;)
    .put(&quot;and&quot;, array(
    primitive(&quot;adding&quot;),
    primitive(&quot;stuff&quot;),
    object().put(&quot;is&quot;, &quot;easy&quot;).get(),
    array(&quot;another array&quot;)))
    .put(&quot;numbers&quot;, 42)
    .put(&quot;including_this_one&quot;, 42.0)
    .put(&quot;booleanstoo&quot;, true)
    .put(&quot;nulls_if_you_insist&quot;, nullValue())
    .put(&quot;a&quot;, object().put(&quot;b&quot;, object().put(&quot;c&quot;, true).put(&quot;d&quot;, 42).put(&quot;e&quot;, &quot;hi!&quot;).get()).get())
    .put(&quot;array&quot;,
    array(&quot;1&quot;, &quot;2&quot;, &quot;etc&quot;, &quot;varargs are nice&quot;)).get();
    
    assertTrue(object instanceof LinkedHashMap, &quot;JsonObject actually extends LinkedHashMap&quot;);
    
    // get with varargs, a natural evolution for Map
    assertTrue(object.get(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;).asPrimitive().asBoolean(), &quot;extract stuff from a nested object&quot;);
    assertTrue(object.getBoolean(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;), &quot;or like this&quot;);
    assertTrue(object.getInt(&quot;a&quot;,&quot;b&quot;,&quot;d&quot;) == 42, &quot;or an integer&quot;);
    assertTrue(object.getString(&quot;a&quot;,&quot;b&quot;,&quot;e&quot;).equals(&quot;hi!&quot;), &quot;or a string&quot;);
    
    assertTrue(object.getArray(&quot;array&quot;).isArray(), &quot;works for arrays as well&quot;);
    assertTrue(object.getObject(&quot;a&quot;,&quot;b&quot;).isObject(), &quot;and objects&quot;);
    
    // builders are nice, but still feels kind of repetitive
    JsonObject anotherObject = object.getOrCreateObject(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;);
    anotherObject.put(&quot;5&quot;, &quot;xxx&quot;);
    assertTrue(object.getString(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;).equals(&quot;xxx&quot;),&quot;yep, we just added a string value 5 levels deep&quot;);
    JsonArray anotherArray = object.getOrCreateArray(&quot;5&quot;,&quot;4&quot;,&quot;3&quot;,&quot;2&quot;,&quot;1&quot;);
    anotherArray.add(&quot;xxx&quot;);
    assertTrue(object.getArray(&quot;5&quot;,&quot;4&quot;,&quot;3&quot;,&quot;2&quot;,&quot;1&quot;).contains(&quot;xxx&quot;),&quot;naturally works for arrays too&quot;);
    
    // Lets do some other stuff
    assertTrue(object.equals(object),
    &quot;equals is implemented as a deep equals&quot;);
    assertTrue(array(&quot;a&quot;, &quot;b&quot;).equals(array(&quot;b&quot;, &quot;a&quot;)),
    &quot;mostly you shouldn't care about the order of stuff in json&quot;);
    assertTrue(
    object().put(&quot;a&quot;, 1).put(&quot;b&quot;, 2).get()
    .equals(
    object().put(&quot;b&quot;, 2).put(&quot;a&quot;, 1).get()),
    &quot;true for objects as well&quot;);
    
    // Arrays are lists
    JsonArray array = array(&quot;foo&quot;, &quot;bar&quot;);
    assertTrue(array instanceof LinkedList, &quot;JsonArray extends LinkedList&quot;);
    assertTrue(array.get(1) == array.get(&quot;bar&quot;), &quot;returns the same object&quot;);
    assertTrue(array.contains(&quot;foo&quot;), &quot;obviously&quot;);
    assertTrue(array.contains(primitive(&quot;foo&quot;)), &quot;but this works as well&quot;);
    
    // serialize like this
    String serialized = serialize(object);
    
    // parse it
    JsonElement json = jsonParser.parse(serialized);
    
    // and write it straight to some stream
    write(System.out, json, false);
    
    // or pretty print it like this
    System.out.println(&quot;\n&quot; + serialize(json, true));
    }
    }</p></div>
    ";}
categories:
  - Blog Posts
tags:
  - IMPLIED
  - java
  - LIABILITY
  - maven
  - SOFTWARE
---
**Update 11 July 2011**: *I've done several commits on github since announcing the project here. New features have been added; bugs have been fixed; you can find jsonj on maven central now as well; etc. In short, head over to [github]( https://github.com/jillesvangurp/jsonj) for the latest on this.*

I've just uploaded a weekend project to github. So, here it is, [jsonj]( https://github.com/jillesvangurp/jsonj). Enjoy.

If you read my post on [json](https://www.jillesvangurp.com/2011/04/02/on-java-json-and-complexity/) a few weeks ago, you may have guessed that I'm not entirely happy with the state of json in Java relative to other languages that come with native support for json. I can't fix that entirely but I felt I could do a better job than most other frameworks I've been exposed to.

So, I sat down on Sunday and started pushing this idea of just taking the Collections framework and combining that with the design of the Json classes in GSon, which I use at work currently, and throwing in some useful ideas that I've applied at work. The result is a nice, compact little framework that does most of what I need it to do. I will probably add a few more features to it and expand some of the existing ones. I use some static methods at work that I can probably do in a much nicer way in this framework. 

<!--more-->

Here is some example usage (note, this will likely not stay in sync with the code in github, check there for latest version):

**Updated to version 0.3, check [here](https://github.com/jillesvangurp/jsonj/blob/master/src/test/java/com/github/jsonj/ShowOffTheFramework.java) for latest version**

```JAVA

/**
 * Copyright (c) 2011, Jilles van Gurp
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
package org.jsonj;

import static org.jsonj.tools.JsonBuilder.array;
import static org.jsonj.tools.JsonBuilder.nullValue;
import static org.jsonj.tools.JsonBuilder.object;
import static org.jsonj.tools.JsonBuilder.primitive;
import static org.jsonj.tools.JsonSerializer.serialize;
import static org.jsonj.tools.JsonSerializer.write;
import static org.testng.Assert.assertTrue;

import java.io.IOException;
import java.util.LinkedHashMap;
import java.util.LinkedList;

import org.jsonj.tools.JsonParser;
import org.testng.annotations.Test;

/**
 * Not really a test but a nice place to show off some how to use this.
 */
@Test
public class ShowOffTheFramework {

	/** this could be a singleton or a spring injected object, threadsafe of course. */
	private final JsonParser jsonParser = new JsonParser();;

	public void whatCanThisBabyDo() throws IOException {
		JsonObject object = object()
			.put("its", "just a hash map")
			.put("and", array(
				primitive("adding"),
				primitive("stuff"),
				object().put("is", "easy").get(),
				array("another array")))
			.put("numbers", 42)
			.put("including_this_one", 42.0)
			.put("booleanstoo", true)
			.put("nulls_if_you_insist", nullValue())
			.put("a", object().put("b", object().put("c", true).put("d", 42).put("e", "hi!").get()).get())
			.put("array",
				array("1", "2", "etc", "varargs are nice")).get();

		assertTrue(object instanceof LinkedHashMap, "JsonObject actually extends LinkedHashMap");

		// get with varargs, a natural evolution for Map
		assertTrue(object.get("a","b","c").asPrimitive().asBoolean(), "extract stuff from a nested object");
		assertTrue(object.getBoolean("a","b","c"), "or like this");
		assertTrue(object.getInt("a","b","d") == 42, "or an integer");
		assertTrue(object.getString("a","b","e").equals("hi!"), "or a string");

		assertTrue(object.getArray("array").isArray(), "works for arrays as well");
		assertTrue(object.getObject("a","b").isObject(), "and objects");

		// builders are nice, but still feels kind of repetitive
		JsonObject anotherObject = object.getOrCreateObject("1","2","3","4");
		anotherObject.put("5", "xxx");
		assertTrue(object.getString("1","2","3","4","5").equals("xxx"),"yep, we just added a string value 5 levels deep");
		JsonArray anotherArray = object.getOrCreateArray("5","4","3","2","1");
		anotherArray.add("xxx");
		assertTrue(object.getArray("5","4","3","2","1").contains("xxx"),"naturally works for arrays too");

		// Lets do some other stuff
		assertTrue(object.equals(object),
			"equals is implemented as a deep equals");
		assertTrue(array("a", "b").equals(array("b", "a")),
			"mostly you shouldn't care about the order of stuff in json");
		assertTrue(
			object().put("a", 1).put("b", 2).get()
			.equals(
				object().put("b", 2).put("a", 1).get()),
			"true for objects as well");

		// Arrays are lists
		JsonArray array = array("foo", "bar");
		assertTrue(array instanceof LinkedList, "JsonArray extends LinkedList");
		assertTrue(array.get(1) == array.get("bar"), "returns the same object");
		assertTrue(array.contains("foo"), "obviously");
		assertTrue(array.contains(primitive("foo")), "but this works as well");

		// serialize like this
		String serialized = serialize(object);

		// parse it
		JsonElement json = jsonParser.parse(serialized);

		// and write it straight to some stream
		write(System.out, json, false);

		// or pretty print it like this
		System.out.println("\n" + serialize(json, true));
	}
}

```

